{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/rudrabhaskar/Desktop/Github-Desktop/Github_Desktop/x402_Hedge_Fund_Agent/agent-hedge-fund/frontend/lib/payment-middleware.ts"],"sourcesContent":["/**\n * X402 Payment Middleware\n * Handles micropayments for API endpoints\n */\n\nimport { NextRequest, NextResponse } from \"next/server\"\n\n// Payment configuration\nexport const PAYMENT_CONFIG = {\n  \"GET /api/models/[id]/details\": {\n    accepts: [\"ethereum\", \"base-sepolia\"],\n    description: \"View model details and analytics\",\n    amount: \"0.0001\", // ETH\n    amountWei: BigInt(\"100000000000000\"), // 0.0001 ETH in wei\n  },\n  \"POST /api/models/[id]/invest\": {\n    accepts: [\"ethereum\", \"base-sepolia\"],\n    description: \"Deposit funds into AI model\",\n    amount: \"0.0002\", // ETH\n    amountWei: BigInt(\"200000000000000\"), // 0.0002 ETH in wei\n  },\n  \"POST /api/competitions/[id]/enter\": {\n    accepts: [\"ethereum\", \"base-sepolia\"],\n    description: \"Enter model into competition\",\n    amount: \"0.0005\", // ETH\n    amountWei: BigInt(\"500000000000000\"), // 0.0005 ETH in wei\n  },\n} as const\n\nexport type PaymentRoute = keyof typeof PAYMENT_CONFIG\n\n/**\n * Payment middleware factory\n * Creates middleware for specific routes\n */\nexport function paymentMiddleware(\n  routes: Record<string, { accepts: string[]; description: string; amount: string; amountWei: bigint }>\n) {\n  return async (req: NextRequest, route: string): Promise<{ authorized: boolean; error?: string }> => {\n    const config = routes[route]\n    \n    if (!config) {\n      return { authorized: true } // Route not protected\n    }\n\n    // Get payment from request headers or body\n    const paymentProof = req.headers.get(\"x-payment-proof\")\n    const paymentAddress = req.headers.get(\"x-payment-address\")\n    const paymentAmount = req.headers.get(\"x-payment-amount\")\n\n    // For now, we'll verify payment on the backend\n    // In production, this would verify on-chain payment or use x402 SDK\n    if (!paymentProof || !paymentAddress) {\n      return {\n        authorized: false,\n        error: `Payment required: ${config.description} (${config.amount} ETH)`,\n      }\n    }\n\n    // Verify payment amount matches\n    if (paymentAmount && BigInt(paymentAmount) < config.amountWei) {\n      return {\n        authorized: false,\n        error: `Insufficient payment. Required: ${config.amount} ETH`,\n      }\n    }\n\n    // TODO: Verify payment proof on-chain or with x402 SDK\n    // For now, we'll accept any payment proof (for testing)\n    \n    return { authorized: true }\n  }\n}\n\n/**\n * Get payment amount for a route\n */\nexport function getPaymentAmount(route: string): { amount: string; amountWei: bigint } | null {\n  const config = PAYMENT_CONFIG[route as PaymentRoute]\n  if (!config) return null\n  \n  return {\n    amount: config.amount,\n    amountWei: config.amountWei,\n  }\n}\n\n/**\n * Verify payment proof\n * In production, this would verify on-chain or with x402 SDK\n */\nexport async function verifyPayment(\n  address: string,\n  amount: bigint,\n  proof: string,\n  route: string\n): Promise<boolean> {\n  // TODO: Implement actual payment verification\n  // For testnet, we can accept any proof\n  // In production, verify on-chain transaction or x402 stream\n  \n  const config = PAYMENT_CONFIG[route as PaymentRoute]\n  if (!config) return false\n  \n  // Verify amount matches\n  if (amount < config.amountWei) {\n    return false\n  }\n  \n  // For testing, accept any proof\n  // In production, verify the proof is valid\n  return true\n}\n\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;AAKM,MAAM,iBAAiB;IAC5B,gCAAgC;QAC9B,SAAS;YAAC;YAAY;SAAe;QACrC,aAAa;QACb,QAAQ;QACR,WAAW,OAAO;IACpB;IACA,gCAAgC;QAC9B,SAAS;YAAC;YAAY;SAAe;QACrC,aAAa;QACb,QAAQ;QACR,WAAW,OAAO;IACpB;IACA,qCAAqC;QACnC,SAAS;YAAC;YAAY;SAAe;QACrC,aAAa;QACb,QAAQ;QACR,WAAW,OAAO;IACpB;AACF;AAQO,SAAS,kBACd,MAAqG;IAErG,OAAO,OAAO,KAAkB;QAC9B,MAAM,SAAS,MAAM,CAAC,MAAM;QAE5B,IAAI,CAAC,QAAQ;YACX,OAAO;gBAAE,YAAY;YAAK,EAAE,sBAAsB;;QACpD;QAEA,2CAA2C;QAC3C,MAAM,eAAe,IAAI,OAAO,CAAC,GAAG,CAAC;QACrC,MAAM,iBAAiB,IAAI,OAAO,CAAC,GAAG,CAAC;QACvC,MAAM,gBAAgB,IAAI,OAAO,CAAC,GAAG,CAAC;QAEtC,+CAA+C;QAC/C,oEAAoE;QACpE,IAAI,CAAC,gBAAgB,CAAC,gBAAgB;YACpC,OAAO;gBACL,YAAY;gBACZ,OAAO,CAAC,kBAAkB,EAAE,OAAO,WAAW,CAAC,EAAE,EAAE,OAAO,MAAM,CAAC,KAAK,CAAC;YACzE;QACF;QAEA,gCAAgC;QAChC,IAAI,iBAAiB,OAAO,iBAAiB,OAAO,SAAS,EAAE;YAC7D,OAAO;gBACL,YAAY;gBACZ,OAAO,CAAC,gCAAgC,EAAE,OAAO,MAAM,CAAC,IAAI,CAAC;YAC/D;QACF;QAEA,uDAAuD;QACvD,wDAAwD;QAExD,OAAO;YAAE,YAAY;QAAK;IAC5B;AACF;AAKO,SAAS,iBAAiB,KAAa;IAC5C,MAAM,SAAS,cAAc,CAAC,MAAsB;IACpD,IAAI,CAAC,QAAQ,OAAO;IAEpB,OAAO;QACL,QAAQ,OAAO,MAAM;QACrB,WAAW,OAAO,SAAS;IAC7B;AACF;AAMO,eAAe,cACpB,OAAe,EACf,MAAc,EACd,KAAa,EACb,KAAa;IAEb,8CAA8C;IAC9C,uCAAuC;IACvC,4DAA4D;IAE5D,MAAM,SAAS,cAAc,CAAC,MAAsB;IACpD,IAAI,CAAC,QAAQ,OAAO;IAEpB,wBAAwB;IACxB,IAAI,SAAS,OAAO,SAAS,EAAE;QAC7B,OAAO;IACT;IAEA,gCAAgC;IAChC,2CAA2C;IAC3C,OAAO;AACT"}},
    {"offset": {"line": 149, "column": 0}, "map": {"version":3,"sources":["file:///Users/rudrabhaskar/Desktop/Github-Desktop/Github_Desktop/x402_Hedge_Fund_Agent/agent-hedge-fund/frontend/app/api/models/%5Bid%5D/details/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\nimport { paymentMiddleware, PAYMENT_CONFIG } from \"@/lib/payment-middleware\"\n\nconst middleware = paymentMiddleware(PAYMENT_CONFIG)\n\n/**\n * GET /api/models/[id]/details\n * Protected by x402 payment middleware\n */\nexport async function GET(\n  req: NextRequest,\n  { params }: { params: Promise<{ id: string }> }\n) {\n  const resolvedParams = await params\n  const modelId = resolvedParams.id\n\n  // Check payment\n  const { authorized, error } = await middleware(req, \"GET /api/models/[id]/details\")\n  \n  if (!authorized) {\n    return NextResponse.json(\n      { error: error || \"Payment required\", requiresPayment: true },\n      { status: 402 } // Payment Required\n    )\n  }\n\n  // Payment verified, return model details\n  // In production, fetch from contract or database\n  return NextResponse.json({\n    modelId: Number(modelId),\n    details: \"Full model details unlocked after payment\",\n    // Add actual model data here\n  })\n}\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,aAAa,IAAA,yLAAiB,EAAC,sLAAc;AAM5C,eAAe,IACpB,GAAgB,EAChB,EAAE,MAAM,EAAuC;IAE/C,MAAM,iBAAiB,MAAM;IAC7B,MAAM,UAAU,eAAe,EAAE;IAEjC,gBAAgB;IAChB,MAAM,EAAE,UAAU,EAAE,KAAK,EAAE,GAAG,MAAM,WAAW,KAAK;IAEpD,IAAI,CAAC,YAAY;QACf,OAAO,sLAAY,CAAC,IAAI,CACtB;YAAE,OAAO,SAAS;YAAoB,iBAAiB;QAAK,GAC5D;YAAE,QAAQ;QAAI,EAAE,mBAAmB;;IAEvC;IAEA,yCAAyC;IACzC,iDAAiD;IACjD,OAAO,sLAAY,CAAC,IAAI,CAAC;QACvB,SAAS,OAAO;QAChB,SAAS;IAEX;AACF"}}]
}